# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.167877128565, 0.167877128565,0.167877128565,0.167877128565,0.0975372931445,0.0676885389484,0.0432949856111,0.0432949856111,0.0432949856111,0.0464996544738,0.0432949856111,0.0432949856111,0.0441104073585,0.0432949856111,0.0449848918033,0.0538875689513,0.0539071915404,0.0583493691445,0.0610490185604,0.0610490185604,0.0583493691445,0.0610490185604,0.0689868050606,0.0979776229927,0.0997803330183,0.0997803330183,0.0997803330183,0.0997803330183,0.0997803330183,0.0997803330183,0.0979776229927,0.108429768713,0.119388357311,0.123190206266,0.123190206266,0.123190206266,0.123190206266,0.12445966114,0.12445966114,0.12445966114,0.12445966114,0.126393528649,0.103811752433,0.110444401981,0.104937143033,0.103811752433,0.0953494492812,0.0953494492812,0.0953494492812,0.0953494492812,0.0953494492812,0.0953494492812,0.0953494492812,0.0953494492812,0.0953494492812)
L_hpd_M95=c(0.352730240126, 0.352730240126,0.352730240126,0.352730240126,0.33184876152,0.325809071706,0.246452093837,0.143945513219,0.126827149227,0.128798540443,0.121964663146,0.121964663146,0.120944653122,0.122559197733,0.129987210922,0.142728965844,0.142728965844,0.160866686491,0.169877272109,0.170399815723,0.17340002147,0.186411838673,0.21759847004,0.223402122166,0.223402122166,0.223402122166,0.223402122166,0.223402122166,0.223402122166,0.223958798871,0.242704124465,0.352034250287,0.403733815225,0.414693368708,0.418012867584,0.418012867584,0.418012867584,0.418012867584,0.418012867584,0.428750793299,0.428750793299,0.428750793299,0.41540562498,0.418012867584,0.41540562498,0.41540562498,0.407124372061,0.412848165767,0.412848165767,0.412848165767,0.412848165767,0.418012867584,0.418012867584,0.424538835365,0.424538835365)
M_hpd_m95=c(0.864052454022, 0.864052454022,0.0936603466276,0.0936603466276,0.0936603466276,0.0948655744971,0.0936603466276,0.0936603466276,0.0925603124932,0.0925603124932,0.0925603124932,0.0925603124932,0.0925603124932,0.0925603124932,0.0925603124932,0.0925603124932,0.0925603124932,0.0925603124932,0.0925603124932,0.0925603124932,0.0925603124932,0.0936603466276,0.087086696454,0.0658964235702,0.0567114679701,0.040809204439,0.0357304330832,0.0342325642456,0.0305127276302,0.0305127276302,0.0305127276302,0.0305127276302,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456,0.0342325642456)
M_hpd_M95=c(1.54587021178, 1.54587021178,0.144690470411,0.144690470411,0.144690470411,0.144690470411,0.140728983926,0.136402160123,0.134420779611,0.134420779611,0.134420779611,0.134420779611,0.134420779611,0.134420779611,0.134420779611,0.134420779611,0.134420779611,0.134420779611,0.134420779611,0.134420779611,0.134420779611,0.138610681188,0.136402160123,0.138051577057,0.131536279581,0.13002480577,0.12355174218,0.114783485061,0.100219079754,0.0974997285308,0.0974997285308,0.0974997285308,0.100219079754,0.100219079754,0.0974997285308,0.0974997285308,0.0974997285308,0.0974997285308,0.0974997285308,0.0969141151743,0.0969141151743,0.0969141151743,0.0969141151743,0.0969141151743,0.0969141151743,0.0969141151743,0.0969141151743,0.0969141151743,0.0969141151743,0.0969141151743,0.0969141151743,0.0969141151743,0.0969141151743,0.0969141151743,0.0969141151743)
R_hpd_m95=c(-1.2980879214, -1.2980879214,0.0330292822795,0.0330292822795,-0.00981214074508,-0.047943592174,-0.0755105677262,-0.0784441781549,-0.0706966783813,-0.0706966783813,-0.0746005770031,-0.0746005770031,-0.0706966783813,-0.0690978281563,-0.0701752206619,-0.0728019178805,-0.0690978281563,-0.0664897049898,-0.0701752206619,-0.0573356538522,-0.0553281853055,-0.0542569004961,-0.047943592174,-0.0102524999905,-0.0102524999905,-0.0102524999905,0.00452643578441,0.0202435980487,0.033738433042,0.033738433042,0.033738433042,0.0293884894437,0.0458435202835,0.0423648641349,0.0423648641349,0.0423648641349,0.0423648641349,0.070281449945,0.0478500996117,0.0458445622275,0.0458445622275,0.0461041392173,0.0461041392173,0.0461041392173,0.0344091468168,0.0344091468168,0.0344091468168,0.0179031550737,0.0179031550737,0.0179031550737,0.0179031550737,0.0287737861907,0.0287737861907,0.0287737861907,0.0287737861907)
R_hpd_M95=c(-0.606828499604, -0.606828499604,0.231248971406,0.231248971406,0.229058934501,0.223432416107,0.147690890009,0.0514738303915,0.019302913191,0.0179097564547,0.0136077726596,0.0136077726596,0.0136077726596,0.0182320844419,0.0201345342187,0.0201345342187,0.0330292822795,0.0470667360145,0.0550176509871,0.0708537473847,0.0708537473847,0.0763919359664,0.10641581884,0.141201097108,0.145751912149,0.146212594188,0.172445954208,0.176575366164,0.176575366164,0.174829339317,0.210012847224,0.297343060555,0.355777283996,0.370482957738,0.376340089619,0.376340089619,0.376340089619,0.394466030377,0.376340089619,0.376340089619,0.376340089619,0.376340089619,0.381170515918,0.376340089619,0.355777283996,0.355777283996,0.355777283996,0.355777283996,0.355777283996,0.355777283996,0.355777283996,0.381170515918,0.381170515918,0.381170515918,0.381170515918)
L_mean=c(0.255909436851, 0.255909436851,0.255922745949,0.255922745949,0.239982076106,0.21784973778,0.102418096162,0.086498926639,0.08346140143,0.0830693995678,0.0824673695001,0.0824673695001,0.0815090041369,0.0825311326174,0.0853980294072,0.0872072268842,0.0898147878634,0.0945715094744,0.102229529962,0.107184891448,0.111846500971,0.12445666481,0.153518330108,0.163362540857,0.162808146607,0.162901144909,0.162917006172,0.163190051188,0.163190051188,0.163513942107,0.168631692567,0.19986731029,0.248945531508,0.263611280789,0.27585005454,0.276915843584,0.276644080502,0.277236227376,0.274929635354,0.275426278948,0.277057106316,0.277733902584,0.274455996246,0.266596096156,0.262841971512,0.262121478267,0.25231737897,0.251829011824,0.25180616276,0.251981876109,0.251942540009,0.254181019469,0.253090780426,0.253273171607,0.253273171607)
M_mean=c(1.1511090141, 1.1511090141,0.121911011705,0.121911011705,0.121911011705,0.121983726742,0.120606494116,0.118284324554,0.116300917021,0.116300917021,0.11630448321,0.11630448321,0.11630448321,0.11630448321,0.11630448321,0.11630448321,0.11630448321,0.11630448321,0.11630448321,0.11630448321,0.11630448321,0.115790038881,0.115407253576,0.112005648164,0.108581686997,0.0923625026917,0.0745400968553,0.0674140892845,0.0652583348823,0.0649375122197,0.0649375122197,0.0649375122197,0.0649090945486,0.0649090945486,0.0647643188247,0.0647643188247,0.0647643188247,0.0647643188247,0.0647643188247,0.0646442195991,0.0646442195991,0.0646442195991,0.0646442195991,0.0646442195991,0.0646442195991,0.0646442195991,0.0646442195991,0.0646442195991,0.0646442195991,0.0646442195991,0.0646442195991,0.0646442195991,0.0646442195991,0.0646442195991,0.0646442195991)
R_mean=c(-0.895199577251, -0.895199577251,0.134011734244,0.134011734244,0.118071064401,0.0958660110376,-0.018188397954,-0.0317853979152,-0.0328395155909,-0.0332315174532,-0.03383711371,-0.03383711371,-0.0347954790732,-0.0337733505928,-0.030906453803,-0.0290972563259,-0.0264896953467,-0.0217329737357,-0.0140749532478,-0.00911959176165,-0.00445798223888,0.00866662592813,0.0381110765325,0.0513568926925,0.0542264596095,0.0705386422173,0.088376909317,0.095775961904,0.0979317163061,0.0985764298875,0.103694180347,0.13492979807,0.184036436959,0.198702186241,0.211085735716,0.212151524759,0.211879761677,0.212471908551,0.21016531653,0.210782059349,0.212412886717,0.213089682984,0.209811776647,0.201951876557,0.198197751913,0.197477258668,0.187673159371,0.187184792225,0.187161943161,0.18733765651,0.18729832041,0.18953679987,0.188446560827,0.188628952008,0.188628952008)
trans=0.5
age=(0:(55-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.471625872629), xlim = c(-57.75,2.75), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.70045723296), xlim = c(-57.75,2.75), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.42789671354, 0.433912633414), xlim = c(-57.75,2.75), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-57.75,2.75), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()